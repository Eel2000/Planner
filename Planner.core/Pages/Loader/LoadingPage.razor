@page "/loading/{user}"
@inject NavigationManager navigator


<div class="centering">
    <div class="spinner"></div>
</div>

@code {
    [Parameter]
    public string? user { get; set; }

    private User? data;

    protected override void OnInitialized()
    {
        base.OnInitialized();
        if (string.IsNullOrWhiteSpace(user))
        {
            throw new KeyNotFoundException("Failed to load ressources");
        }

        data = JsonConvert.DeserializeObject<User>(Encoding.Default.GetString(Convert.FromBase64String(user)));
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await Task.Delay(3000);//simulate data initialization
        //TODO: load user workspace data here and pass it to worskpasse page
        navigator.NavigateTo($"/workspace/{data?.Id}");
    }
}
